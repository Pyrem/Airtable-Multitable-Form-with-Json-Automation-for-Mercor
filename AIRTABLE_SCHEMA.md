# Airtable Schema Documentation

This document describes the complete Airtable base schema for the Multi-Table Form Automation system.

## Overview

The base consists of five tables:
1. **Applicants** (parent table)
2. **Personal Details** (one-to-one with Applicants)
3. **Work Experience** (one-to-many with Applicants)
4. **Salary Preferences** (one-to-one with Applicants)
5. **Shortlisted Leads** (auto-populated helper table)

## Table Schemas

### 1. Applicants Table

**Purpose**: Main table that stores one row per applicant and holds compressed JSON plus LLM outputs.

| Field Name | Type | Description | Required |
|------------|------|-------------|----------|
| Applicant ID | Primary Key | Unique identifier for each applicant | Yes |
| Compressed JSON | Long Text | Single JSON object containing all applicant data | No |
| Shortlist Status | Single Select | Status: "Shortlisted", "Not Shortlisted", or empty | No |
| LLM Summary | Long Text | 75-word summary generated by LLM | No |
| LLM Score | Number | Quality score from 1-10 assigned by LLM | No |
| LLM Issues | Long Text | Data gaps or inconsistencies identified by LLM | No |
| LLM Follow-Ups | Long Text | Follow-up questions suggested by LLM | No |

**Single Select Options for Shortlist Status**:
- Shortlisted
- Not Shortlisted

### 2. Personal Details Table

**Purpose**: Stores personal information for each applicant (one-to-one relationship).

| Field Name | Type | Description | Required |
|------------|------|-------------|----------|
| Record ID | Primary Key | Auto-generated unique identifier | Yes |
| Applicant ID | Link to Applicants | Links back to parent Applicants table | Yes |
| Full Name | Single Line Text | Applicant's full name | Yes |
| Email | Email | Applicant's email address | Yes |
| Location | Single Line Text | Country or city of residence | Yes |
| LinkedIn | URL | LinkedIn profile URL | No |

### 3. Work Experience Table

**Purpose**: Stores work history for each applicant (one-to-many relationship).

| Field Name | Type | Description | Required |
|------------|------|-------------|----------|
| Record ID | Primary Key | Auto-generated unique identifier | Yes |
| Applicant ID | Link to Applicants | Links back to parent Applicants table | Yes |
| Company | Single Line Text | Name of the company | Yes |
| Title | Single Line Text | Job title or role | Yes |
| Start Date | Date | Employment start date (YYYY-MM-DD format) | Yes |
| End Date | Date | Employment end date (YYYY-MM-DD format, blank if current) | No |
| Technologies | Long Text | Technologies, languages, or tools used | No |
| Description | Long Text | Brief description of responsibilities | No |

### 4. Salary Preferences Table

**Purpose**: Stores compensation and availability preferences (one-to-one relationship).

| Field Name | Type | Description | Required |
|------------|------|-------------|----------|
| Record ID | Primary Key | Auto-generated unique identifier | Yes |
| Applicant ID | Link to Applicants | Links back to parent Applicants table | Yes |
| Preferred Rate | Currency or Number | Desired hourly rate | Yes |
| Minimum Rate | Currency or Number | Minimum acceptable hourly rate | No |
| Currency | Single Select | Currency code (USD, EUR, GBP, etc.) | Yes |
| Availability (hrs/wk) | Number | Available hours per week | Yes |

**Single Select Options for Currency**:
- USD
- EUR
- GBP
- CAD
- INR

### 5. Shortlisted Leads Table

**Purpose**: Auto-populated table containing applicants who meet shortlist criteria.

| Field Name | Type | Description | Required |
|------------|------|-------------|----------|
| Record ID | Primary Key | Auto-generated unique identifier | Yes |
| Applicant | Link to Applicants | Links to the shortlisted applicant | Yes |
| Compressed JSON | Long Text | Copy of the applicant's compressed JSON | Yes |
| Score Reason | Long Text | Human-readable explanation of why shortlisted | Yes |
| Created At | Date/Time | Timestamp when lead was created | Yes |

## Field Dependencies and Formulas

### In Applicants Table

You can add computed fields using Airtable formulas:

**Total Experience** (Formula field):
```
IF({Compressed JSON}, VALUE(REGEX_EXTRACT({Compressed JSON}, '"total_experience_years":\\s*(\\d+\\.?\\d*)')), 0)
```

**Has Tier-1 Experience** (Formula field):
```
OR(
  FIND("Google", {Compressed JSON}),
  FIND("Meta", {Compressed JSON}),
  FIND("OpenAI", {Compressed JSON}),
  FIND("Microsoft", {Compressed JSON}),
  FIND("Amazon", {Compressed JSON})
) > 0
```

## Linked Record Fields

All child tables link back to the parent Applicants table using the **Applicant ID** field.

**Configuration**:
- Allow linking to multiple records: **No** (for Personal Details and Salary Preferences)
- Allow linking to multiple records: **Yes** (for Work Experience, as one applicant can have multiple jobs)
- Allow linking to only records in a specific view: **No**
- Limit record selection to a view: **None**

## Views

### Applicants Table Views

1. **All Applicants**: Shows all applicants
2. **Shortlisted**: Filters where `Shortlist Status = "Shortlisted"`
3. **High Scores**: Filters where `LLM Score >= 7`
4. **Needs Review**: Filters where `Compressed JSON` is empty

### Shortlisted Leads Table Views

1. **All Leads**: Shows all shortlisted leads
2. **Recent**: Sorted by `Created At` descending

## Setup Instructions

### Step 1: Create the Base

1. Log in to Airtable
2. Create a new base called "Applicant Management"

### Step 2: Create Tables

Create each table as described above. Start with the Applicants table, then create the child tables.

### Step 3: Configure Linked Records

For each child table, add the "Applicant ID" field as a **Link to another record** field:
1. Click **+** to add a new field
2. Choose **Link to another record**
3. Select the **Applicants** table
4. Name the field **Applicant ID**

### Step 4: Create Forms

Create three separate Airtable forms:

1. **Personal Details Form**: Collects name, email, location, LinkedIn
2. **Work Experience Form**: Collects company, title, dates, technologies
3. **Salary Preferences Form**: Collects rates, currency, availability

Each form should include:
- A field to enter or select the Applicant ID
- All required fields for that table
- Instructions to submit all three forms

### Step 5: Configure API Access

1. Go to [https://airtable.com/create/tokens](https://airtable.com/create/tokens)
2. Create a new personal access token
3. Grant the following scopes:
   - `data.records:read`
   - `data.records:write`
   - `schema.bases:read`
4. Add access to your base
5. Copy the API key to your `.env` file

### Step 6: Get Base ID

1. Go to [https://airtable.com/api](https://airtable.com/api)
2. Select your base
3. Copy the Base ID (starts with "app...")
4. Add it to your `.env` file

## Example Data

### Applicants Table
| Applicant ID | Compressed JSON | Shortlist Status | LLM Score |
|--------------|-----------------|------------------|-----------|
| rec001 | {"personal": {...}, "experience": [...], "salary": {...}} | Shortlisted | 8 |

### Personal Details Table
| Record ID | Applicant ID | Full Name | Email | Location |
|-----------|--------------|-----------|-------|----------|
| rec101 | rec001 | Jane Doe | jane@example.com | San Francisco, CA |

### Work Experience Table
| Record ID | Applicant ID | Company | Title | Start Date | End Date |
|-----------|--------------|---------|-------|------------|----------|
| rec201 | rec001 | Google | Software Engineer | 2019-01-15 | 2021-06-30 |
| rec202 | rec001 | Meta | Senior Engineer | 2021-07-01 | |

### Salary Preferences Table
| Record ID | Applicant ID | Preferred Rate | Currency | Availability (hrs/wk) |
|-----------|--------------|----------------|----------|-----------------------|
| rec301 | rec001 | 95 | USD | 30 |

## Notes

- All table names and field names should NOT contain emojis
- Use consistent naming conventions (Title Case for table names, Title Case for field names)
- Date fields should use YYYY-MM-DD format for consistency with scripts
- Currency fields can be either Currency type or Number type with a separate Currency selector
- The Compressed JSON field should be Long Text to accommodate large JSON objects
